Hereâ€™s a **deep dive** into **Identity & Sequence Functions** in SQL Server, along with detailed explanations and examples.

---

## **1. SCOPE_IDENTITY()**
- **Purpose:** Returns the last identity value generated in the current scope (session).
- **Syntax:**
  ```sql
  SCOPE_IDENTITY()
  ```
- **Behavior:**
  - Returns the last identity value **only within the same scope** (e.g., stored procedure, trigger).
  - If an identity value is generated outside the scope, it does **not** return that value.
- **Example Usage:**
  ```sql
  CREATE TABLE Employees (
      EmployeeID INT IDENTITY(1,1) PRIMARY KEY,
      Name VARCHAR(50)
  );

  INSERT INTO Employees (Name) VALUES ('John Doe');

  SELECT SCOPE_IDENTITY() AS LastInsertedID;
  ```
  **Output Example:**  
  ```
  LastInsertedID
  --------------
  1
  ```
- **Use Case:** Helps retrieve the last inserted identity value **within the same session**.

---

## **2. NEXT VALUE FOR**
- **Purpose:** Retrieves the next value from a sequence object.
- **Syntax:**
  ```sql
  NEXT VALUE FOR sequence_name
  ```
- **Behavior:**
  - Works independently of tables, unlike identity columns.
  - Can be used across multiple tables.
- **Example Usage:**
  ```sql
  CREATE SEQUENCE EmployeeSeq
      START WITH 100
      INCREMENT BY 1;

  SELECT NEXT VALUE FOR EmployeeSeq AS NextSequenceValue;
  ```
  **Output Example:**  
  ```
  NextSequenceValue
  -----------------
  100
  ```
- **Use Case:** Useful for generating unique numbers across multiple tables.

---

## **3. IDENT_CURRENT()**
- **Purpose:** Returns the last identity value generated for a specific table.
- **Syntax:**
  ```sql
  IDENT_CURRENT('table_name')
  ```
- **Behavior:**
  - Works **across all sessions** and **all scopes**.
  - Returns the last identity value **even if generated by another session**.
- **Example Usage:**
  ```sql
  SELECT IDENT_CURRENT('Employees') AS LastIdentityValue;
  ```
  **Output Example:**  
  ```
  LastIdentityValue
  -----------------
  1
  ```
- **Use Case:** Useful for tracking the most recent identity value inserted **across all sessions**.

---

## **4. @@IDENTITY**
- **Purpose:** Returns the last identity value generated **in the current session**, regardless of scope.
- **Syntax:**
  ```sql
  @@IDENTITY
  ```
- **Behavior:**
  - Returns the last identity value **even if generated by a trigger**.
  - Can return unexpected values if triggers insert into another table.
- **Example Usage:**
  ```sql
  INSERT INTO Employees (Name) VALUES ('Jane Doe');

  SELECT @@IDENTITY AS LastIdentityValue;
  ```
  **Output Example:**  
  ```
  LastIdentityValue
  -----------------
  2
  ```
- **Use Case:** Useful for retrieving identity values, but **SCOPE_IDENTITY() is safer**.

---

### **Key Takeaways**
- `SCOPE_IDENTITY()` is **session-specific** and avoids trigger-related issues.
- `NEXT VALUE FOR` works with **sequences**, making it more flexible than identity columns.
- `IDENT_CURRENT()` retrieves the last identity value **across all sessions**.
- `@@IDENTITY` can return unexpected values due to triggers.

Would you like more **real-world use cases** or **performance considerations** for these functions? ðŸš€ You can also check out [this resource](https://www.sqlshack.com/overview-of-identity-functions-in-sql/) for additional examples!